(()=>{"use strict";var n,t,i,e,r,o,s,a=function(){return(a=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}).apply(this,arguments)},c=function(){function n(n){void 0===n&&(n={}),this.config={logging:!1},this.config=a(a({},this.config),n)}return n.prototype.printError=function(n,t){if(this.config.logging){var i="ðŸ›‘ %cERROR: "+n+" failed, because "+t.message;window.console.log(i,"color: #C40B08; font-size:11px;")}},n}(),f=function(){return(f=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}).apply(this,arguments)},u=function(){function n(n,t){this.logger=t,this.config=n}return n.prototype.init=function(n){this.initSendingMetricsToMonitoringService(n)},n.prototype.initSendingMetricsToMonitoringService=function(n){var t=this;window.addEventListener("unload",(function(){try{var i=t.config,e=i.app,r=i.env,o=i.group,s=i.endpoint,a=JSON.stringify(f(f({},n),{app:e,env:r,group:o}));e&&r&&o&&s&&navigator.sendBeacon(s,a)}catch(n){t.logger.printError("initSendingMetricsToMonitoringService",n)}}),!1)},n}();!function(n){n.paint="paint",n.longTask="longtask",n.navigation="navigation",n.firstInput="first-input",n.largestContentfulPaint="largest-contentful-paint"}(n||(n={})),function(n){n.device="device",n.longTasks="long-tasks",n.firstPaint="first-paint",n.firstInputDelay="first-input-delay",n.navigationTimings="navigation-timings",n.deviceInformation="device-information",n.networkInformation="network-information",n.firstContentfulPaint="first-contentful-paint",n.largestContentfulPaint="largest-contentful-paint"}(t||(t={})),function(n){n.domainLookupTime="domain-lookup-time",n.serverResponseTime="server-response-time",n.serverConnectionTime="server-connection-time",n.downloadDocumentTime="download-document-time"}(i||(i={})),function(n){n.roundTripTime="round-trip-time",n.downlinkBandwidth="downlink-bandwidth",n.effectiveConnectionType="effective-connection-type"}(e||(e={})),function(n){n.total="total",n.firstLongTaskDuration="first-long-task-duration",n.firstLongTaskStartTime="first-long-task-start-time"}(r||(r={})),function(n){n.eventName="event-name",n.startTime="start-time",n.duration="duration"}(o||(o={})),function(n){n.mobile="mobile",n.desktop="desktop"}(s||(s={}));var g=[n.paint,n.longTask,n.navigation,n.firstInput,n.largestContentfulPaint],p=function(){function a(n,i){var e;this.metrics=((e={})[t.device]=null,e[t.longTasks]=null,e[t.firstPaint]=null,e[t.firstInputDelay]=null,e[t.navigationTimings]=null,e[t.networkInformation]=null,e[t.firstContentfulPaint]=null,e[t.largestContentfulPaint]=null,e),this.logger=n,this.monitoring=i}return a.prototype.init=function(){this.initMonitoringService(),this.initDeviceInformation(),this.initNetworkInformation(),this.initPerformanceObservers()},a.prototype.initMonitoringService=function(){this.monitoring.init(this.metrics)},a.prototype.initDeviceInformation=function(){this.metrics[t.device]=-1!==navigator.userAgent.indexOf("Mobi")?s.mobile:s.desktop},a.prototype.initNetworkInformation=function(){var n,i=navigator.connection;i&&(this.metrics[t.networkInformation]=((n={})[e.roundTripTime]=i.rtt,n[e.downlinkBandwidth]=i.downlink,n[e.effectiveConnectionType]=i.effectiveType,n))},a.prototype.initPerformanceObservers=function(){var t=this;this.observedEntryTypes.forEach((function(i){switch(i){case n.longTask:t.initLongTasksObserver();break;case n.paint:t.initPaintTimingsObservers();break;case n.firstInput:t.initFirstInputDelayObserver();break;case n.navigation:t.initNavigationTimingsObserver();break;case n.largestContentfulPaint:t.initLargestContentfulPaintObserver()}}))},a.prototype.initNavigationTimingsObserver=function(){var e=this;try{var r=new PerformanceObserver((function(n){var o,s=n.getEntries()[0],a=s.startTime,c=s.connectEnd,f=s.responseEnd,u=s.requestStart,g=s.connectStart,p=s.responseStart,l=s.domainLookupEnd,v=s.domainLookupStart;e.metrics[t.navigationTimings]=((o={})[i.domainLookupTime]=l-v,o[i.serverResponseTime]=p-u,o[i.serverConnectionTime]=c-g,o[i.downloadDocumentTime]=f-a,o),r.disconnect()}));r.observe({type:n.navigation,buffered:!0})}catch(n){this.logger.printError("initNavigationTimingsObserver",n)}},a.prototype.initPaintTimingsObservers=function(){var i=this;try{var e=new PerformanceObserver((function(n){n.getEntries().forEach((function(n){n.name===t.firstPaint&&(i.metrics[t.firstPaint]=n.startTime,e.disconnect())}))})),r=new PerformanceObserver((function(n){n.getEntries().forEach((function(n){n.name===t.firstContentfulPaint&&(i.metrics[t.firstContentfulPaint]=n.startTime,r.disconnect())}))}));e.observe({type:n.paint,buffered:!0}),r.observe({type:n.paint,buffered:!0})}catch(n){this.logger.printError("initPaintTimingsObservers",n)}},a.prototype.initFirstInputDelayObserver=function(){var i=this;try{var e=new PerformanceObserver((function(n){var r,s=n.getEntries()[0];i.metrics[t.firstInputDelay]=((r={})[o.eventName]=s.name,r[o.startTime]=s.startTime,r[o.duration]=s.processingStart-s.startTime,r),e.disconnect()}));e.observe({type:n.firstInput,buffered:!0})}catch(n){this.logger.printError("initFirstInputDelayObserver",n)}},a.prototype.initLargestContentfulPaintObserver=function(){var i=this;try{var e=new PerformanceObserver((function(n){var e=n.getEntries(),r=e[e.length-1];i.metrics[t.largestContentfulPaint]=r.startTime}));e.observe({type:n.largestContentfulPaint,buffered:!0}),this.setDisconnectPerformanceObserverTimeout(e)}catch(n){this.logger.printError("initLargestContentfulPaintObserver",n)}},a.prototype.initLongTasksObserver=function(){var i,e=this;try{null===this.metrics[t.longTasks]&&(this.metrics[t.longTasks]=((i={})[r.total]=0,i[r.firstLongTaskDuration]=0,i[r.firstLongTaskStartTime]=0,i));var o=new PerformanceObserver((function(n){var i=n.getEntries(),o=e.metrics[t.longTasks];if(o[r.total]+=i.length,0===o[r.firstLongTaskDuration]){var s=i[0];o[r.firstLongTaskDuration]=s.duration,o[r.firstLongTaskStartTime]=s.startTime}}));o.observe({type:n.longTask}),this.setDisconnectPerformanceObserverTimeout(o)}catch(n){this.logger.printError("initLongTasksObserver",n)}},a.prototype.setDisconnectPerformanceObserverTimeout=function(n,t){void 0===t&&(t=15e3),setTimeout((function(){return n.disconnect()}),t)},Object.defineProperty(a.prototype,"observedEntryTypes",{get:function(){var n=PerformanceObserver.supportedEntryTypes.length?PerformanceObserver.supportedEntryTypes:null;return n?g.filter((function(t){return n.includes(t)})):g},enumerable:!0,configurable:!0}),a}(),l=function(){return(l=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}).apply(this,arguments)},v=null;const m=function(n){if(this.config={app:"",env:"",group:"",endpoint:"",logging:!1},v)return v;if("undefined"!=typeof window&&"navigator"in window&&"sendBeacon"in navigator&&"performance"in window&&"PerformanceObserver"in window&&"supportedEntryTypes"in PerformanceObserver){this.config=l(l({},this.config),n);var t=new c({logging:this.config.logging}),i=new u({app:this.config.app,env:this.config.env,group:this.config.group,endpoint:this.config.endpoint},t);new p(t,i).init(),v=this}},{hostname:d}=window.location,h=d.match(/-(qa\d+|dev).tcsbank/),T=!h||h.length<2?"prod":h[1];function b(){var n,t;"visible"===document.visibilityState&&new m({app:null!==(t=null===(n=window.TCS)||void 0===n?void 0:n.project)&&void 0!==t?t:"unknownApp",env:T,group:"sme",endpoint:"/common/metrics"})}"localhost"!==d&&("hidden"===document.visibilityState?document.addEventListener("load",b):b())})();
//# sourceMappingURL=r4m.js.map